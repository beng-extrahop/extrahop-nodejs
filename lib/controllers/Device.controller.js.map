{"version":3,"sources":["../../src/controllers/Device.controller.js"],"names":["BaseCtrl","require","DeviceSet","DeviceSearch","DeviceActivity","AlertSet","DashboardSet","DeviceGroupSet","SoftwareSet","TagSet","TriggerSet","Search","module","exports","params","getDevices","options","searchDevices","device","data","patchDevice","getDeviceActivity","getDeviceAlerts","alert","postDeviceAlert","alerts","postDeviceAlerts","assign","map","id","deleteDeviceAlert","unassign","getDeviceDashboards","getDeviceDeviceGroups","deviceGroup","postDeviceDeviceGroup","deviceGroups","postDeviceDeviceGroups","deleteDeviceDeviceGroup","getDeviceSoftware","getDeviceTags","getDeviceTriggers","trigger","postDeviceTrigger","triggers","postDeviceTriggers","deleteDeviceTrigger","get","search_type","limit","name","value","discoveryId","Types","DiscoveryId","ip","IpAddress","mac","MacAddress","vendor","Vendor","type","Type","tag","Tag","activity","Activity","node","Node","vlan","Vlan","discoverTime","DiscoverTime","getAll","with","extrahopId","extrahop_id","parentId","parent_id","custom_type","description","update","customName","custom_name","customType","role","process","appliance","getDevice","search","postDeviceSearch","postDeviceTags","postDeviceTag"],"mappings":"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","file":"Device.controller.js","sourcesContent":["// Device.controller.js\n\nconst BaseCtrl = require('../controllers/_base/BaseCtrl.controller');\nconst DeviceSet = require('../models/device/DeviceSet.model');\nconst DeviceSearch = require('../models/device/DeviceSearch.model');\nconst DeviceActivity = require('../models/device/DeviceActivity.model');\n\nconst AlertSet = require('../models/alert/AlertSet.model');\nconst DashboardSet = require('../models/dashboard/DashboardSet.model');\nconst DeviceGroupSet = require('../models/deviceGroup/DeviceGroupSet.model');\nconst SoftwareSet = require('../models/software/SoftwareSet.model');\nconst TagSet = require('../models/tag/TagSet.model');\nconst TriggerSet = require('../models/trigger/TriggerSet.model');\n\nconst { Search } = require('../constants/Global.constants');\n\nmodule.exports = class DeviceCtrl extends BaseCtrl {\n\n  // -------------------------------------\n  // Defaults\n  // -------------------------------------\n\n  get(params = {}) {\n    return new DeviceSet(...this.getDevices(params));\n  }\n\n  search(options = {}) {\n    return new DeviceSet(...this.searchDevices(new DeviceSearch(options)));\n  }\n\n  update(device, data) {\n    return this.patchDevice(device, data);\n  }\n\n  getActivity(device) {\n    return new DeviceActivity(this.getDeviceActivity(device));\n  }\n\n  getAlerts(device) {\n    return new AlertSet(...this.getDeviceAlerts(device));\n  }\n\n  assignAlert(device, alert) {\n    return this.postDeviceAlert(device, alert);\n  }\n\n  assignAlerts(device, alerts) {\n    return this.postDeviceAlerts(device, { assign: alerts.map(alert => alert.id) });\n  }\n\n  removeAlert(device, alert) {\n    return this.deleteDeviceAlert(device, alert);\n  }\n\n  removeAlerts(device, alerts) {\n    return this.postDeviceAlerts(device, { unassign: alerts.map(alert => alert.id) });\n  }\n\n  getDashboards(device) {\n    return new DashboardSet(...this.getDeviceDashboards(device));\n  }\n\n  getDeviceGroups(device) {\n    return new DeviceGroupSet(...this.getDeviceDeviceGroups(device));\n  }\n\n  assignDeviceGroup(device, deviceGroup) {\n    return this.postDeviceDeviceGroup(device, deviceGroup);\n  }\n\n  assignDeviceGroups(device, deviceGroups) {\n    return this.postDeviceDeviceGroups(device, { assign: deviceGroups.map(deviceGroup => deviceGroup.id) });\n  }\n\n  removeDeviceGroup(device, deviceGroup) {\n    return this.deleteDeviceDeviceGroup(device, deviceGroup);\n  }\n\n  removeDeviceGroups(device, deviceGroups) {\n    return this.postDeviceDeviceGroups(device, { unassign: deviceGroups.map(deviceGroup => deviceGroup.id) });\n  }\n\n  getSoftware(device) {\n    return new SoftwareSet(...this.getDeviceSoftware(device));\n  }\n\n  getTags(device) {\n    return new TagSet(...this.getDeviceTags(device));\n  }\n\n  getTriggers(device) {\n    return new TriggerSet(...this.getDeviceTriggers(device));\n  }\n\n  assignTrigger(device, trigger) {\n    return this.postDeviceTrigger(device, trigger);\n  }\n\n  assignTriggers(device, triggers) {\n    return this.postDeviceTriggers(device, { assign: triggers.map(trigger => trigger.id) });\n  }\n\n  removeTrigger(device, trigger) {\n    return this.deleteDeviceTrigger(device, trigger);\n  }\n\n  removeTriggers(device, triggers) {\n    return this.postDeviceTriggers(device, { unassign: triggers.map(trigger => trigger.id) });\n  }\n\n  // -------------------------------------\n  // Helper Functions - GET\n  // -------------------------------------\n\n  getAll() {\n    return this.get({ search_type: 'any', limit: -1 });\n  }\n\n  getByName(name) {\n    return this.get({ search_type: 'name', value: name });\n  }\n\n  getByDiscoveryId(discoveryId) {\n    return this.get({ search_type: Search.Types.DiscoveryId, value: discoveryId });\n  }\n\n  getByIpAddress(ip) {\n    return this.get({ search_type: Search.Types.IpAddress, value: ip });\n  }\n\n  getByMacAddress(mac) {\n    return this.get({ search_type: Search.Types.MacAddress, value: mac });\n  }\n\n  getByVendor(vendor) {\n    return this.get({ search_type: Search.Types.Vendor, value: vendor });\n  }\n\n  getByType(type) {\n    return this.get({ search_type: Search.Types.Type, value: type });\n  }\n\n  getByTag(tag) {\n    return this.get({ search_type: Search.Types.Tag, value: tag });\n  }\n\n  getByActivity(activity) {\n    return this.get({ search_type: Search.Types.Activity, value: activity });\n  }\n\n  getByNode(node) {\n    return this.get({ search_type: Search.Types.Node, value: node });\n  }\n\n  getByVlan(vlan) {\n    return this.get({ search_type: Search.Types.Vlan, value: vlan });\n  }\n\n  getByDiscoverTime(discoverTime) {\n    return this.get({ search_type: Search.Types.DiscoverTime, value: discoverTime });\n  }\n\n  // -------------------------------------\n  // Find Functions - Custom\n  // -------------------------------------\n\n  getById(id) {\n    return this.getAll().with({ id });\n  }\n\n  getByExtrahopId(extrahopId) {\n    return this.getAll().with({ extrahop_id: extrahopId });\n  }\n\n  getByParentId(parentId) {\n    return this.getAll().with({ parent_id: parentId });\n  }\n\n  getCustom() {\n    return this.getAll().with({ custom_type: 'custom' });\n  }\n\n  // -------------------------------------\n  // Update Functions\n  // -------------------------------------\n\n  setDescription(device, description) {\n    return this.update(device, { description });\n  }\n\n  setCustomName(device, customName) {\n    return this.update(device, { custom_name: customName });\n  }\n\n  setCustomType(device, customType) {\n    return this.update(device, { custom_type: customType });\n  }\n\n  setRole(device, role) {\n    return this.update(device, { custom_type: role });\n  }\n\n  setVendor(device, vendor) {\n    return this.update(device, { vendor });\n  }\n\n  // -------------------------------------\n  // Base Functions\n  // -------------------------------------\n\n  getDevices(params) {\n    return this.process(this.appliance.getDevices(params), 'devices');\n  }\n\n  getDevice(device) {\n    return this.process(this.appliance.getDevice(device.id), 'device');\n  }\n\n  searchDevices(search) {\n    return this.process(this.appliance.postDeviceSearch(search), 'devices');\n  }\n\n  patchDevice(device, data) {\n    return this.process(this.appliance.patchDevice(device.id, data), `device (id: ${device.id})`);\n  }\n\n  // -------------------------------------\n  // Activity Functions\n  // -------------------------------------\n\n  getDeviceActivity(device) {\n    return this.process(this.appliance.getDeviceActivity(device.id), 'device activity');\n  }\n\n  // -------------------------------------\n  // Alert Functions\n  // -------------------------------------\n\n  getDeviceAlerts(device) {\n    return this.process(this.appliance.getDeviceAlerts(device.id), 'device alerts');\n  }\n\n  postDeviceAlerts(device, { assign, unassign }) {\n    return this.process(this.appliance.postDeviceAlerts(device.id, { assign, unassign }), 'device alerts');\n  }\n\n  postDeviceAlert(device, alert) {\n    return this.process(this.appliance.postDeviceAlert(device.id, alert.id), 'device alert');\n  }\n\n  deleteDeviceAlert(device, alert) {\n    return this.process(this.appliance.deleteDeviceAlert(device.id, alert.id), 'device alert');\n  }\n\n  // -------------------------------------\n  // Dashboard Functions\n  // -------------------------------------\n\n  getDeviceDashboards(device) {\n    return this.process(this.appliance.getDeviceDashboards(device.id), 'device dashboards');\n  }\n\n  // -------------------------------------\n  // DeviceGroup Functions\n  // -------------------------------------\n\n  getDeviceDeviceGroups(device) {\n    return this.process(this.appliance.getDeviceDeviceGroups(device.id), 'device deviceGroups');\n  }\n\n  postDeviceDeviceGroups(device, { assign, unassign }) {\n    return this.process(this.appliance.postDeviceDeviceGroups(device.id, { assign, unassign }), 'device deviceGroups');\n  }\n\n  postDeviceDeviceGroup(device, deviceGroup) {\n    return this.process(this.appliance.postDeviceDeviceGroup(device.id, deviceGroup.id), 'device deviceGroup');\n  }\n\n  deleteDeviceDeviceGroup(device, deviceGroup) {\n    return this.process(this.appliance.deleteDeviceDeviceGroup(device.id, deviceGroup.id), 'device device group');\n  }\n\n  // -------------------------------------\n  // Software Functions\n  // -------------------------------------\n\n  getDeviceSoftware(device) {\n    return this.process(this.appliance.getDeviceSoftware(device.id), 'device software');\n  }\n\n  // -------------------------------------\n  // Tag Functions\n  // -------------------------------------\n\n  getDeviceTags(device) {\n    return this.process(this.appliance.getDeviceTags(device.id), 'device tags');\n  }\n\n  postDeviceTags(device, { assign, unassign }) {\n    return this.process(this.appliance.postDeviceTags(device.id, { assign, unassign }), 'device tags');\n  }\n\n  postDeviceTag(device, tag) {\n    return this.process(this.appliance.postDeviceTag(device.id, tag.id), 'device tag');\n  }\n\n  deleteDeviceTag(device, tag) {\n    return this.process(this.appliance.deleteDeviceDeviceGroup(device.id, tag.id), 'device tag');\n  }\n\n  // -------------------------------------\n  // Trigger Functions\n  // -------------------------------------\n\n  getDeviceTriggers(device) {\n    return this.process(this.appliance.getDeviceTriggers(device.id), 'device triggers');\n  }\n\n  postDeviceTriggers(device, { assign, unassign }) {\n    return this.process(this.appliance.postDeviceTriggers(device.id, { assign, unassign }), 'device triggers');\n  }\n\n  postDeviceTrigger(device, trigger) {\n    return this.process(this.appliance.postDeviceTrigger(device.id, trigger.id), 'device trigger');\n  }\n\n  deleteDeviceTrigger(device, trigger) {\n    return this.process(this.appliance.deleteDeviceDeviceGroup(device.id, trigger.id), 'device trigger');\n  }\n};\n"]}