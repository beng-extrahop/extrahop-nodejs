{"version":3,"sources":["../../src/controllers/Trigger.controller.js"],"names":["BaseCtrl","require","Trigger","TriggerSet","Strings","module","exports","trigger","getTrigger","getTriggers","find","author","filter","Filters","indexOf","id","name","username","owner","type","property","skip","disabled","patchTrigger","process","appliance","payload"],"mappings":"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","file":"Trigger.controller.js","sourcesContent":["// Trigger.controller.js\n\nconst BaseCtrl = require('../controllers/_base/BaseCtrl.controller');\nconst Trigger = require('../models/trigger/Trigger.model');\nconst TriggerSet = require('../models/trigger/TriggerSet.model');\nconst Strings = require('../constants/Global.constants');\n\nmodule.exports = class TriggerCtrl extends BaseCtrl {\n\n  // -------------------------------------\n  // Defaults\n  // -------------------------------------\n\n  get(trigger) {\n    return trigger ? new Trigger(this.getTrigger(trigger)) : new TriggerSet(...this.getTriggers());\n  }\n\n  // -------------------------------------\n  // Get Triggers\n  // -------------------------------------\n\n  findAll() {\n    return this.find(null);\n  }\n\n  findByAuthor(author, filter = 'equals') {\n    return this.find({ author }, Strings.Filters.indexOf(filter));\n  }\n\n  findById(id, filter = 'equals') {\n    return this.find({ id }, Strings.Filters.indexOf(filter));\n  }\n\n  findByName(name, filter = 'equals') {\n    return this.find({ name }, Strings.Filters.indexOf(filter));\n  }\n\n  findByOwner(username, filter = 'equals') {\n    return this.find({ owner: username }, Strings.Filters.indexOf(filter));\n  }\n\n  findByType(type, filter = 'equals') {\n    return this.find({ type }, Strings.Filters.indexOf(filter));\n  }\n\n  findBy(property, filter = 'equals') {\n    return this.find(property, Strings.Filters.indexOf(filter));\n  }\n\n  // -------------------------------------\n  // Edit Trigger\n  // -------------------------------------\n\n  enable(trigger, skip = true) {\n    if (!trigger.disabled && skip) {\n      return null;\n    }\n\n    return this.patchTrigger(trigger, { disabled: false });\n  }\n\n  disable(trigger, skip = true) {\n    if (trigger.disabled && skip) {\n      return null;\n    }\n\n    return this.patchTrigger(trigger, { disabled: true });\n  }\n\n  toggle(trigger) {\n    return this.patchTrigger(trigger, { disabled: !trigger.disabled });\n  }\n\n  // -------------------------------------\n  // API Functions\n  // -------------------------------------\n\n  getTriggers() {\n    return this.process(this.appliance.getTriggers(), 'triggers');\n  }\n\n  getTrigger(trigger) {\n    return this.process(this.appliance.getTrigger(trigger.id), 'trigger');\n  }\n\n  patchTrigger(trigger, payload) {\n    return this.appliance.patchTrigger(trigger.id, payload);\n  }\n};\n"]}